Cache: keySize: 4, valueSize: 688, dim: 172, capacity: 65536, maxQueryNum: 65536, deviceId: 0
has edge feature
total 470713 for train, can cache 65536, 0.1392270874184482%
Epoch 0:
save model at epoch 0
	train loss:213986.4318  val ap:0.988022  val auc:0.990411
	total time:1158.632s sample time:196.154s prep time:947.982s
Epoch 1:
save model at epoch 1
	train loss:124538.6314  val ap:0.988614  val auc:0.991820
	total time:847.204s sample time:142.527s prep time:692.682s
Epoch 2:
save model at epoch 2
	train loss:116965.4468  val ap:0.989372  val auc:0.992305
	total time:739.681s sample time:124.908s prep time:602.231s
Epoch 3:
	train loss:119447.8615  val ap:0.989340  val auc:0.992120
	total time:707.616s sample time:118.216s prep time:576.958s
Epoch 4:
save model at epoch 4
	train loss:111011.4423  val ap:0.992059  val auc:0.994273
	total time:627.691s sample time:105.484s prep time:511.204s
Epoch 5:
save model at epoch 5
	train loss:99899.8072  val ap:0.992279  val auc:0.994286
	total time:443.909s sample time:74.470s prep time:360.200s
Epoch 6:
save model at epoch 6
	train loss:98024.5030  val ap:0.992794  val auc:0.994632
	total time:440.041s sample time:73.408s prep time:357.074s
Epoch 7:
save model at epoch 7
	train loss:95035.5126  val ap:0.993752  val auc:0.995211
	total time:389.663s sample time:65.528s prep time:315.303s
Epoch 8:
save model at epoch 8
	train loss:88224.3381  val ap:0.994330  val auc:0.995593
	total time:307.442s sample time:50.068s prep time:249.783s
Epoch 9:
	train loss:85033.5712  val ap:0.994218  val auc:0.995563
	total time:325.007s sample time:53.759s prep time:263.285s
Epoch 10:
save model at epoch 10
	train loss:85761.3946  val ap:0.994751  val auc:0.996012
	total time:267.702s sample time:43.864s prep time:216.567s
Epoch 11:
save model at epoch 11
	train loss:86283.4134  val ap:0.994786  val auc:0.996003
	total time:227.859s sample time:37.335s prep time:183.622s
Epoch 12:
save model at epoch 12
	train loss:82325.1060  val ap:0.995038  val auc:0.996317
	total time:244.001s sample time:40.468s prep time:196.293s
Epoch 13:
save model at epoch 13
	train loss:79245.7599  val ap:0.995558  val auc:0.996421
	total time:140.259s sample time:20.598s prep time:113.687s
Epoch 14:
save model at epoch 14
	train loss:77704.5531  val ap:0.995885  val auc:0.996714
	total time:95.117s sample time:11.784s prep time:78.078s
Epoch 15:
	train loss:77746.9709  val ap:0.995775  val auc:0.996667
	total time:93.092s sample time:11.379s prep time:76.451s
Epoch 16:
save model at epoch 16
	train loss:76251.9329  val ap:0.996249  val auc:0.996887
	total time:98.331s sample time:13.329s prep time:79.721s
Epoch 17:
	train loss:74553.3475  val ap:0.996109  val auc:0.996943
	total time:19.148s sample time:0.542s prep time:13.889s
Epoch 18:
	train loss:74671.4688  val ap:0.996052  val auc:0.996889
	total time:14.644s sample time:0.523s prep time:9.282s
Epoch 19:
save model at epoch 19
	train loss:74071.7747  val ap:0.996664  val auc:0.997204
	total time:12.035s sample time:0.172s prep time:7.500s
Epoch 20:
	train loss:73096.3900  val ap:0.996325  val auc:0.996995
	total time:11.949s sample time:0.430s prep time:6.985s
Epoch 21:
	train loss:71369.5039  val ap:0.996386  val auc:0.997032
	total time:11.280s sample time:0.182s prep time:6.707s
Epoch 22:
	train loss:71408.7778  val ap:0.996509  val auc:0.997172
	total time:12.800s sample time:0.206s prep time:8.079s
ap don't improve in 3 epoches, early stop
average statistics: 
	 average_prep time: 255.3722162661345
	 time_total 90.439 s
	total sample time: 17.836 s
	total sample node: 492987.75, self._n_sample_per_node [10]
	 time_forward: 0.679
	 time_memory: 5.267
	 time_message: 5.113
	 time_backward 1.159s
	 time_message 51.200s
Loading model at epoch 19...
	test AP:0.996428  test AUC:0.997130
