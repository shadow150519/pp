Cache: keySize: 4, valueSize: 688, dim: 172, capacity: 524288, maxQueryNum: 65536, deviceId: 0
has edge feature
total 470713 for train, can cache 524288, 1.1138166993475855%
Epoch 0:
save model at epoch 0
	train loss:222802.2939  val ap:0.987661  val auc:0.989975
	total time:1165.083s sample time:193.987s prep time:955.070s
Epoch 1:
save model at epoch 1
	train loss:124218.8182  val ap:0.988630  val auc:0.991754
	total time:841.772s sample time:143.653s prep time:685.350s
Epoch 2:
	train loss:106503.4648  val ap:0.988615  val auc:0.991422
	total time:737.415s sample time:124.544s prep time:601.162s
Epoch 3:
save model at epoch 3
	train loss:110895.0153  val ap:0.989665  val auc:0.992663
	total time:707.555s sample time:119.399s prep time:575.430s
Epoch 4:
save model at epoch 4
	train loss:94627.9716  val ap:0.991881  val auc:0.993881
	total time:626.748s sample time:105.496s prep time:510.570s
Epoch 5:
save model at epoch 5
	train loss:94191.7071  val ap:0.992705  val auc:0.994713
	total time:445.294s sample time:74.358s prep time:361.288s
Epoch 6:
save model at epoch 6
	train loss:89586.8929  val ap:0.993554  val auc:0.995168
	total time:437.295s sample time:73.949s prep time:353.866s
Epoch 7:
save model at epoch 7
	train loss:82378.0794  val ap:0.994345  val auc:0.995642
	total time:392.771s sample time:65.591s prep time:318.137s
Epoch 8:
save model at epoch 8
	train loss:80891.1262  val ap:0.994365  val auc:0.995791
	total time:303.650s sample time:50.067s prep time:245.302s
Epoch 9:
save model at epoch 9
	train loss:80455.8885  val ap:0.994712  val auc:0.995871
	total time:311.243s sample time:51.247s prep time:251.833s
Epoch 10:
save model at epoch 10
	train loss:78860.5066  val ap:0.995382  val auc:0.996325
	total time:243.524s sample time:38.524s prep time:197.163s
Epoch 11:
save model at epoch 11
	train loss:75904.9995  val ap:0.996023  val auc:0.996755
	total time:164.243s sample time:24.030s prep time:133.899s
Epoch 12:
	train loss:73402.4327  val ap:0.995869  val auc:0.996672
	total time:17.712s sample time:0.975s prep time:11.933s
Epoch 13:
	train loss:73594.2806  val ap:0.995915  val auc:0.996743
	total time:17.951s sample time:0.730s prep time:12.454s
Epoch 14:
save model at epoch 14
	train loss:70677.6261  val ap:0.996319  val auc:0.997022
	total time:17.409s sample time:0.623s prep time:12.037s
Epoch 15:
save model at epoch 15
	train loss:69867.5514  val ap:0.996444  val auc:0.997124
	total time:16.442s sample time:0.690s prep time:11.127s
Epoch 16:
save model at epoch 16
	train loss:68645.3476  val ap:0.996666  val auc:0.997237
	total time:17.889s sample time:0.708s prep time:12.519s
Epoch 17:
save model at epoch 17
	train loss:67896.8999  val ap:0.996723  val auc:0.997313
	total time:16.634s sample time:0.741s prep time:11.290s
Epoch 18:
save model at epoch 18
	train loss:67710.9330  val ap:0.996744  val auc:0.997247
	total time:16.387s sample time:0.764s prep time:11.030s
Epoch 19:
save model at epoch 19
	train loss:66584.6146  val ap:0.996905  val auc:0.997423
	total time:17.085s sample time:0.798s prep time:11.699s
Epoch 20:
	train loss:65729.8692  val ap:0.996486  val auc:0.997168
	total time:16.887s sample time:0.664s prep time:11.626s
Epoch 21:
save model at epoch 21
	train loss:63726.6684  val ap:0.997086  val auc:0.997533
	total time:15.910s sample time:0.655s prep time:10.669s
Epoch 22:
	train loss:64982.2332  val ap:0.996953  val auc:0.997546
	total time:17.214s sample time:0.804s prep time:11.791s
Epoch 23:
save model at epoch 23
	train loss:64472.6657  val ap:0.997221  val auc:0.997646
	total time:17.907s sample time:0.906s prep time:12.340s
Epoch 24:
	train loss:64210.6922  val ap:0.996973  val auc:0.997568
	total time:17.299s sample time:0.713s prep time:11.966s
Epoch 25:
	train loss:62976.1021  val ap:0.997064  val auc:0.997665
	total time:17.926s sample time:0.842s prep time:12.443s
Epoch 26:
save model at epoch 26
	train loss:62043.0523  val ap:0.997416  val auc:0.997816
	total time:17.014s sample time:0.832s prep time:11.573s
Epoch 27:
	train loss:61302.6889  val ap:0.997227  val auc:0.997730
	total time:16.371s sample time:0.836s prep time:10.907s
Epoch 28:
	train loss:62090.1214  val ap:0.997332  val auc:0.997783
	total time:17.031s sample time:0.711s prep time:11.719s
Epoch 29:
save model at epoch 29
	train loss:61682.3247  val ap:0.997499  val auc:0.997892
	total time:17.156s sample time:0.667s prep time:11.820s
Epoch 30:
	train loss:60805.2839  val ap:0.997306  val auc:0.997743
	total time:17.634s sample time:0.940s prep time:12.057s
Epoch 31:
save model at epoch 31
	train loss:60772.8241  val ap:0.997530  val auc:0.997949
	total time:16.606s sample time:0.575s prep time:11.420s
Epoch 32:
save model at epoch 32
	train loss:59297.6371  val ap:0.997531  val auc:0.997895
	total time:16.906s sample time:0.613s prep time:11.703s
Epoch 33:
	train loss:59246.6657  val ap:0.997481  val auc:0.997890
	total time:16.929s sample time:0.844s prep time:11.506s
Epoch 34:
save model at epoch 34
	train loss:59532.5190  val ap:0.997642  val auc:0.997956
	total time:14.731s sample time:0.396s prep time:9.776s
Epoch 35:
	train loss:58882.8783  val ap:0.997478  val auc:0.997891
	total time:15.279s sample time:0.560s prep time:10.111s
Epoch 36:
	train loss:59482.7020  val ap:0.997526  val auc:0.997901
	total time:14.752s sample time:0.478s prep time:9.710s
Epoch 37:
	train loss:58738.2392  val ap:0.997614  val auc:0.998003
	total time:15.024s sample time:0.418s prep time:10.002s
ap don't improve in 3 epoches, early stop
average statistics: 
	 average_prep time: 144.37620872572847
	 time_total 85.158 s
	total sample time: 16.384 s
	total sample node: 814501.5, self._n_sample_per_node [10]
	 time_forward: 0.989
	 time_memory: 4.906
	 time_message: 4.670
	 time_backward 1.535s
	 time_message 46.758s
Loading model at epoch 34...
	test AP:0.997214  test AUC:0.997595
