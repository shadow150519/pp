Cache: keySize: 4, valueSize: 688, dim: 172, capacity: 65536, maxQueryNum: 65536, deviceId: 0
has edge feature
total 110232 for train, can cache 65536, 0.5945279047826403%
Epoch 0:
save model at epoch 0
	train loss:135588.3635  val ap:0.866948  val auc:0.897430
	total time:279.942s sample time:45.928s prep time:229.894s
Epoch 1:
save model at epoch 1
	train loss:81624.5933  val ap:0.876713  val auc:0.932957
	total time:273.618s sample time:45.795s prep time:225.037s
Epoch 2:
	train loss:68637.9877  val ap:0.870680  val auc:0.931649
	total time:265.213s sample time:44.016s prep time:218.557s
Epoch 3:
save model at epoch 3
	train loss:62786.4273  val ap:0.889746  val auc:0.939459
	total time:267.463s sample time:46.106s prep time:218.091s
Epoch 4:
save model at epoch 4
	train loss:59731.5565  val ap:0.899385  val auc:0.942542
	total time:269.942s sample time:46.560s prep time:220.941s
Epoch 5:
save model at epoch 5
	train loss:58348.6228  val ap:0.909805  val auc:0.946308
	total time:192.840s sample time:32.993s prep time:157.364s
Epoch 6:
save model at epoch 6
	train loss:56799.5043  val ap:0.916110  val auc:0.948114
	total time:173.582s sample time:29.947s prep time:141.348s
Epoch 7:
save model at epoch 7
	train loss:56200.9769  val ap:0.920257  val auc:0.949171
	total time:171.619s sample time:29.220s prep time:139.992s
Epoch 8:
save model at epoch 8
	train loss:54751.8398  val ap:0.926281  val auc:0.952085
	total time:172.042s sample time:30.274s prep time:139.544s
Epoch 9:
save model at epoch 9
	train loss:54723.3370  val ap:0.930045  val auc:0.953719
	total time:173.101s sample time:29.529s prep time:140.856s
Epoch 10:
save model at epoch 10
	train loss:53413.7920  val ap:0.935555  val auc:0.955466
	total time:171.649s sample time:28.929s prep time:140.521s
Epoch 11:
save model at epoch 11
	train loss:52049.8798  val ap:0.944181  val auc:0.960121
	total time:172.585s sample time:29.241s prep time:140.776s
Epoch 12:
save model at epoch 12
	train loss:51268.1243  val ap:0.945277  val auc:0.961121
	total time:171.863s sample time:29.156s prep time:140.120s
Epoch 13:
save model at epoch 13
	train loss:50319.5531  val ap:0.952958  val auc:0.965580
	total time:170.869s sample time:29.398s prep time:139.280s
Epoch 14:
Traceback (most recent call last):
  File "/home/wtx/workspace/cpp_project/tgl/train_cache.py", line 295, in <module>
    ap, auc = eval('val')
  File "/home/wtx/workspace/cpp_project/tgl/train_cache.py", line 164, in eval
    aps.append(average_precision_score(y_true, y_pred))
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 214, in wrapper
    return func(*args, **kwargs)
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 268, in average_precision_score
    return _average_binary_score(
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/sklearn/metrics/_base.py", line 75, in _average_binary_score
    return binary_metric(y_true, y_score, sample_weight=sample_weight)
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 230, in _binary_uninterpolated_average_precision
    precision, recall, _ = precision_recall_curve(
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/sklearn/utils/_param_validation.py", line 187, in wrapper
    return func(*args, **kwargs)
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 952, in precision_recall_curve
    fps, tps, thresholds = _binary_clf_curve(
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/sklearn/metrics/_ranking.py", line 810, in _binary_clf_curve
    assert_all_finite(y_score)
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/sklearn/utils/validation.py", line 200, in assert_all_finite
    _assert_all_finite(
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/sklearn/utils/validation.py", line 122, in _assert_all_finite
    _assert_all_finite_element_wise(
  File "/home/wtx/miniconda3/envs/dgl/lib/python3.10/site-packages/sklearn/utils/validation.py", line 171, in _assert_all_finite_element_wise
    raise ValueError(msg_err)
ValueError: Input contains NaN.
